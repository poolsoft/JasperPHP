<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Jasperphp by Rctnet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Jasperphp</h1>
      <h2 class="project-tagline">Projeto para ler arquivos JRXML feitos no &quot;JasperSoft Studio&quot; e gerar relatórios em PDF</h2>
      <a href="https://github.com/Rctnet/JasperPHP" class="btn">View on GitHub</a>
      <a href="https://github.com/Rctnet/JasperPHP/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/Rctnet/JasperPHP/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="jasperphp" class="anchor" href="#jasperphp" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>JasperPHP</h1>

<p>Projeto para gerar relatórios criados com o o aplicativo JasperSoft Studio<br>
Biblioteca produzida interiramente em php, ou seja se a nessecidade de um servidor java</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-pse">&lt;?php</span><span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">JasperPHP\Report</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">JasperPHP\Report2XLS</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">JasperPHP\ado\TTransaction</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">JasperPHP\ado\TLoggerHTML</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//use PHPexcel as PHPexcel;</span></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c">* classe TJasper</span></span>
<span class="pl-s1"><span class="pl-c">* encapsula uma ação</span></span>
<span class="pl-s1"><span class="pl-c">*</span></span>
<span class="pl-s1"><span class="pl-c">* <span class="pl-k">@author</span>   Rogerio Muniz de Castro &lt;rogerio@singularsistemas.net&gt;</span></span>
<span class="pl-s1"><span class="pl-c">* <span class="pl-k">@version</span>  2015.03.11</span></span>
<span class="pl-s1"><span class="pl-c">* <span class="pl-k">@access</span>   <span class="pl-ii">restrict</span></span></span>
<span class="pl-s1"><span class="pl-c">* </span></span>
<span class="pl-s1"><span class="pl-c">* 2015.03.11 -- criação</span></span>
<span class="pl-s1"><span class="pl-c">**/</span></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">TJasper</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1">    <span class="pl-k">private</span> <span class="pl-smi">$report</span>;</span>
<span class="pl-s1">    <span class="pl-k">private</span> <span class="pl-smi">$type</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c">    * método __construct()</span></span>
<span class="pl-s1"><span class="pl-c">    * instancia uma nova ação</span></span>
<span class="pl-s1"><span class="pl-c">    * <span class="pl-k">@param</span> $action = método a ser executado</span></span>
<span class="pl-s1"><span class="pl-c">    */</span></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-c1">__construct</span>(<span class="pl-smi">$jrxml</span>,<span class="pl-smi">$param</span>)</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$xmlFile</span><span class="pl-k">=</span>  <span class="pl-smi">$jrxml</span>;</span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">type</span> <span class="pl-k">=</span> (<span class="pl-c1">array_key_exists</span>(<span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span>,<span class="pl-smi">$param</span>))?<span class="pl-smi">$param</span>[<span class="pl-s"><span class="pl-pds">'</span>type<span class="pl-pds">'</span></span>]:<span class="pl-s"><span class="pl-pds">'</span>pdf<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1">        <span class="pl-c1">error_reporting</span>(<span class="pl-c1">0</span>);</span>
<span class="pl-s1">        <span class="pl-k">switch</span> (<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">type</span>)</span>
<span class="pl-s1">        {</span>
<span class="pl-s1">            <span class="pl-k">case</span> <span class="pl-s"><span class="pl-pds">'</span>pdf<span class="pl-pds">'</span></span>: </span>
<span class="pl-s1">                <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">report</span> <span class="pl-k">=</span><span class="pl-k">new</span> <span class="pl-c1">JasperPHP\</span><span class="pl-c1">Report</span>(<span class="pl-smi">$xmlFile</span>,<span class="pl-smi">$param</span>);</span>
<span class="pl-s1">                <span class="pl-c1">JasperPHP\</span><span class="pl-c1">Pdf</span><span class="pl-k">::</span>prepare(<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">report</span>);</span>
<span class="pl-s1">                <span class="pl-k">break</span>;</span>
<span class="pl-s1">            <span class="pl-k">case</span> <span class="pl-s"><span class="pl-pds">'</span>xls<span class="pl-pds">'</span></span>:</span>
<span class="pl-s1">                <span class="pl-c1">JasperPHP\</span><span class="pl-c1">Excel</span><span class="pl-k">::</span>prepare();</span>
<span class="pl-s1">                <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">report</span> <span class="pl-k">=</span><span class="pl-k">new</span> <span class="pl-c1">JasperPHP\</span><span class="pl-c1">Report2XLS</span>(<span class="pl-smi">$xmlFile</span>,<span class="pl-smi">$param</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1">                <span class="pl-k">break</span>;</span>
<span class="pl-s1">        }</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">outpage</span>(<span class="pl-smi">$type</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>pdf<span class="pl-pds">'</span></span>){</span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">report</span><span class="pl-k">-&gt;</span>generate();</span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">report</span><span class="pl-k">-&gt;</span>out();</span>
<span class="pl-s1">        <span class="pl-k">switch</span> (<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">type</span>)</span>
<span class="pl-s1">        {</span>
<span class="pl-s1">            <span class="pl-k">case</span> <span class="pl-s"><span class="pl-pds">'</span>pdf<span class="pl-pds">'</span></span>:</span>
<span class="pl-s1">                <span class="pl-smi">$pdf</span>  <span class="pl-k">=</span> <span class="pl-c1">JasperPHP\</span><span class="pl-c1">Pdf</span><span class="pl-k">::</span>get();</span>
<span class="pl-s1">                <span class="pl-smi">$pdf</span><span class="pl-k">-&gt;</span>Output(<span class="pl-s"><span class="pl-pds">'</span>Relatorio.pdf<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">"</span>I<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">                <span class="pl-k">break</span>;</span>
<span class="pl-s1">            <span class="pl-k">case</span> <span class="pl-s"><span class="pl-pds">'</span>xls<span class="pl-pds">'</span></span>:</span>
<span class="pl-s1">                <span class="pl-c1">header</span>(<span class="pl-s"><span class="pl-pds">'</span>Content-Type: application/vnd.ms-excel<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">                <span class="pl-c1">header</span>(<span class="pl-s"><span class="pl-pds">'</span>Content-Disposition: attachment;filename="01simple.xls"<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">                <span class="pl-c1">header</span>(<span class="pl-s"><span class="pl-pds">'</span>Cache-Control: max-age=0<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">                <span class="pl-c">// If you're serving to IE 9, then the following may be needed</span></span>
<span class="pl-s1">                <span class="pl-c1">header</span>(<span class="pl-s"><span class="pl-pds">'</span>Cache-Control: max-age=1<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">                <span class="pl-c">// If you're serving to IE over SSL, then the following may be needed</span></span>
<span class="pl-s1">                <span class="pl-c1">header</span> (<span class="pl-s"><span class="pl-pds">'</span>Expires: Mon, 26 Jul 1997 05:00:00 GMT<span class="pl-pds">'</span></span>); <span class="pl-c">// Date in the past</span></span>
<span class="pl-s1">                <span class="pl-c1">header</span> (<span class="pl-s"><span class="pl-pds">'</span>Last-Modified: <span class="pl-pds">'</span></span><span class="pl-k">.</span><span class="pl-c1">gmdate</span>(<span class="pl-s"><span class="pl-pds">'</span>D, d M Y H:i:s<span class="pl-pds">'</span></span>)<span class="pl-k">.</span><span class="pl-s"><span class="pl-pds">'</span> GMT<span class="pl-pds">'</span></span>); <span class="pl-c">// always modified</span></span>
<span class="pl-s1">                <span class="pl-c1">header</span> (<span class="pl-s"><span class="pl-pds">'</span>Cache-Control: cache, must-revalidate<span class="pl-pds">'</span></span>); <span class="pl-c">// HTTP/1.1</span></span>
<span class="pl-s1">                <span class="pl-c1">header</span> (<span class="pl-s"><span class="pl-pds">'</span>Pragma: public<span class="pl-pds">'</span></span>); <span class="pl-c">// HTTP/1.0</span></span>
<span class="pl-s1">                <span class="pl-smi">$objWriter</span> <span class="pl-k">=</span> <span class="pl-c1">PHPExcel_IOFactory</span><span class="pl-k">::</span>createWriter(<span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">report</span><span class="pl-k">-&gt;</span><span class="pl-smi">wb</span>, <span class="pl-s"><span class="pl-pds">'</span>Excel5<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">                <span class="pl-smi">$objWriter</span><span class="pl-k">-&gt;</span>save(<span class="pl-s"><span class="pl-pds">'</span>php://output<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">            <span class="pl-k">break</span>;</span>
<span class="pl-s1">        }</span>
<span class="pl-s1"></span>
<span class="pl-s1">    }</span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">setVariable</span>(<span class="pl-smi">$name</span>,<span class="pl-smi">$value</span>){</span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">report</span><span class="pl-k">-&gt;</span><span class="pl-smi">arrayVariable</span>[<span class="pl-smi">$name</span>][<span class="pl-s"><span class="pl-pds">'</span>initialValue<span class="pl-pds">'</span></span>] <span class="pl-k">=</span> <span class="pl-smi">$value</span> ;</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">}</span>
<span class="pl-s1"><span class="pl-k">require</span>(<span class="pl-s"><span class="pl-pds">'</span>../../autoload.php<span class="pl-pds">'</span></span>) ;</span>
<span class="pl-s1"><span class="pl-c1">TTransaction</span><span class="pl-k">::</span>open(<span class="pl-s"><span class="pl-pds">'</span>dev<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$jasper</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TJasper</span>(<span class="pl-s"><span class="pl-pds">'</span>template.jrxml<span class="pl-pds">'</span></span>,<span class="pl-smi">$_GET</span>);</span>
<span class="pl-s1"><span class="pl-smi">$jasper</span><span class="pl-k">-&gt;</span>outpage();</span>
<span class="pl-s1"></span><span class="pl-pse"><span class="pl-s1">?</span>&gt;</span>
</pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/Rctnet/JasperPHP">Jasperphp</a> is maintained by <a href="https://github.com/Rctnet">Rctnet</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
